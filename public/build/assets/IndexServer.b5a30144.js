import{_ as Z}from"./AdminLayout.48b5d2f1.js";import{u as ee}from"./useAuthorizable.baba4420.js";import{u as te}from"./AppLayout.48200e20.js";import{X as re,r as ae,a4 as B,i as se,S as z,N as ne,c as k,w as f,R as oe,o as c,b as _,u as a,a as d,f as N,t as l,e as E,s as T,d as b,l as J,q as R}from"./app.5bc07c9e.js";import{D as j,_ as ie}from"./DtRowItem.c3460664.js";import{i as V,t as W,w as le,n as de,a as ce}from"./index.1a6f71df.js";import{_ as ue}from"./AlertCard.5db54c20.js";import{r as fe}from"./EyeIcon.3271c736.js";import{r as pe}from"./PencilSquareIcon.0f1f84e3.js";import{r as ye}from"./TrashIcon.b925a7aa.js";import"./XMarkIcon.7c1db738.js";function ge(e){var s;const r=W(e);return(s=r==null?void 0:r.$el)!=null?s:r}const I=V?window:void 0;V&&window.document;V&&window.navigator;V&&window.location;function M(...e){let s,r,t,m;if(typeof e[0]=="string"||Array.isArray(e[0])?([r,t,m]=e,s=I):[s,r,t,m]=e,!s)return de;Array.isArray(r)||(r=[r]),Array.isArray(t)||(t=[t]);const S=[],O=()=>{S.forEach(n=>n()),S.length=0},D=(n,y,w,u)=>(n.addEventListener(y,w,u),()=>n.removeEventListener(y,w,u)),v=se(()=>[ge(s),W(m)],([n,y])=>{O(),n&&S.push(...r.flatMap(w=>t.map(u=>D(n,w,u,y))))},{immediate:!0,flush:"post"}),p=()=>{v(),O()};return ce(p),p}const P=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$="__vueuse_ssr_handlers__",he=_e();function _e(){return $ in P||(P[$]=P[$]||{}),P[$]}function xe(e,s){return he[e]||s}function be(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}var me=Object.defineProperty,F=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable,Q=(e,s,r)=>s in e?me(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,H=(e,s)=>{for(var r in s||(s={}))ve.call(s,r)&&Q(e,r,s[r]);if(F)for(var r of F(s))we.call(s,r)&&Q(e,r,s[r]);return e};const ke={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},Y="vueuse-storage";function Se(e,s,r,t={}){var m;const{flush:S="pre",deep:O=!0,listenToStorageChanges:D=!0,writeDefaults:v=!0,mergeDefaults:p=!1,shallow:n,window:y=I,eventFilter:w,onError:u=i=>{console.error(i)}}=t,h=(n?re:ae)(s);if(!r)try{r=xe("getDefaultStorage",()=>{var i;return(i=I)==null?void 0:i.localStorage})()}catch(i){u(i)}if(!r)return h;const x=W(s),o=be(x),C=(m=t.serializer)!=null?m:ke[o],{pause:K,resume:q}=le(h,()=>U(h.value),{flush:S,deep:O,eventFilter:w});return y&&D&&(M(y,"storage",L),M(y,Y,G)),L(),h;function U(i){try{if(i==null)r.removeItem(e);else{const g=C.write(i),A=r.getItem(e);A!==g&&(r.setItem(e,g),y&&y.dispatchEvent(new CustomEvent(Y,{detail:{key:e,oldValue:A,newValue:g,storageArea:r}})))}}catch(g){u(g)}}function X(i){const g=i?i.newValue:r.getItem(e);if(g==null)return v&&x!==null&&r.setItem(e,C.write(x)),x;if(!i&&p){const A=C.read(g);return typeof p=="function"?p(A,x):o==="object"&&!Array.isArray(A)?H(H({},x),A):A}else return typeof g!="string"?g:C.read(g)}function G(i){L(i.detail)}function L(i){if(!(i&&i.storageArea!==r)){if(i&&i.key==null){h.value=x;return}if(!(i&&i.key!==e)){K();try{h.value=X(i)}catch(g){u(g)}finally{i?B(q):q()}}}}}const Oe={class:"px-10 py-8 mx-auto text-gray-400"},Ae={class:"italic text-gray-400 dark:text-gray-500"},Ne={class:"flex justify-between mb-8"},Ee={class:"font-bold text-3xl text-gray-500 dark:text-gray-300 flex items-center"},De={class:"flex"},Te={class:"hidden md:inline"},je={class:"px-4 py-4 text-sm text-center text-gray-800 whitespace-nowrap dark:text-gray-200 font-bold"},Be={class:"flex items-center"},Ce={class:"flex-shrink-0 h-10 w-10"},Pe=["src"],$e={class:"ml-4"},Ve={class:"text-sm font-medium text-gray-900 dark:text-gray-300"},Le={class:"text-sm text-gray-500 dark:text-gray-400"},Ie={class:"text-sm text-gray-900 dark:text-gray-300"},We={class:"text-sm text-gray-500 dark:text-gray-400"},qe={class:"px-4 space-y-1 whitespace-nowrap"},ze={class:"flex"},Je={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-opacity-25 dark:text-green-400"},Re={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800 dark:bg-opacity-25 dark:text-red-400"},Me={key:2,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800 dark:bg-opacity-25 dark:text-gray-400"},Fe={class:"flex"},Qe={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-opacity-25 dark:text-green-400"},He={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800 dark:bg-opacity-25 dark:text-red-400"},Ye={key:2},Ke={key:3,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800 dark:bg-opacity-25 dark:text-gray-400"},Ue={key:0,class:"italic"},Xe=["title"],Ge={class:"px-6 py-4 space-x-2 text-sm font-medium text-right whitespace-nowrap"},ct={__name:"IndexServer",props:{canCreateBungeeServer:Boolean,servers:Object,filters:Object},setup(e){const s=e,{can:r}=ee(),{__:t}=oe(),{formatTimeAgoToNow:m,formatToDayDateString:S}=te(),O=Se("show-bungee-server-missing-alert",!0),D=[{key:"id",label:t("ID"),sortable:!0,class:"text-center font-bold"},{key:"name",sortable:!0,label:t("Name")},{key:"ip_address",label:t("IP:Port"),sortable:!0},{key:"type",label:t("Type"),sortable:!0},{key:"status",sortable:!1,label:t("Status")},{key:"minecraft_version",sortable:!0,label:t("Version")},{key:"last_scanned_at",sortable:!0,label:t("Last Scanned")},{key:"actions",label:t("Actions"),sortable:!1,class:"w-1/12 text-right"}],v=z({}),p=z({});return ne(()=>{s.servers.data.forEach(n=>{axios.get(route("server.ping.get",n.id)).then(()=>{B(()=>v[n.id]=1)}).catch(()=>{B(()=>v[n.id]=-1)}),n.type.value!==5&&n.webquery_port?axios.get(route("server.webquery.get",n.id)).then(()=>{B(()=>p[n.id]=1)}).catch(()=>{B(()=>p[n.id]=-1)}):p[n.id]=0})}),(n,y)=>{const w=J("app-head"),u=J("InertiaLink"),h=R("tippy"),x=R("confirm");return c(),k(Z,null,{default:f(()=>[_(w,{title:a(t)("Manage Servers")},null,8,["title"]),d("div",Oe,[e.canCreateBungeeServer&&a(O)?(c(),k(ue,{key:0,"close-button":!0,"text-color":"text-light-blue-800 dark:text-light-blue-500","border-color":"border-light-blue-500",onClose:y[0]||(y[0]=o=>O.value=!1)},{body:f(()=>[N(l(a(t)("When a bungee server is not added. Player List Box and Player Status Box (if enabled from settings), use first added server as default query server."))+" ",1),d("p",Ae,l(a(t)("Note: This is not an error. You can safely ignore this message if you don't have proxy server.")),1)]),default:f(()=>[N(l(a(t)("You don't have Bungee/Proxy Server Added!"))+" ",1)]),_:1})):E("",!0),d("div",Ne,[d("h1",Ee,[N(l(a(t)("Servers"))+" ",1),a(r)("create servers")?T((c(),k(u,{key:0,as:"button",title:a(t)("MineTrax automatically scan all servers every hour for new players and statistics updates. Click here to force a scan now. Use it rarely."),href:n.route("admin.server.force-scan"),method:"post",class:"ml-2 inline-flex items-center px-4 py-2 border-2 border-red-600 rounded-md font-semibold text-xs text-red-600 uppercase tracking-widest focus:outline-none transition ease-in-out duration-150 dark:text-red-500 dark:border-red-700 hover:border-red-300 dark:hover:border-red-500 hover:bg-red-500 hover:text-white dark:hover:text-white"},{default:f(()=>[d("span",null,l(a(t)("Rescan all servers")),1)]),_:1},8,["title","href"])),[[h]]):E("",!0)]),d("div",De,[a(r)("create servers")&&e.canCreateBungeeServer?(c(),k(u,{key:0,href:n.route("admin.server.create-bungee"),class:"mr-1 inline-flex items-center px-4 py-2 border-2 border-gray-800 rounded-md font-semibold text-xs text-gray-800 uppercase tracking-widest focus:outline-none focus:border-gray-900 transition ease-in-out duration-150 dark:text-gray-300 dark:border-gray-700 dark:hover:border-gray-500"},{default:f(()=>[d("span",null,l(a(t)("Add Bungee Server")),1)]),_:1},8,["href"])):E("",!0),a(r)("create servers")?(c(),k(u,{key:1,href:n.route("admin.server.create"),class:"inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:shadow-outline-gray transition ease-in-out duration-150"},{default:f(()=>[d("span",null,l(a(t)("Add")),1),d("span",Te,"\xA0"+l(a(t)("Server")),1)]),_:1},8,["href"])):E("",!0)])]),_(ie,{class:"bg-white rounded shadow dark:bg-gray-800",header:D,data:e.servers,filters:e.filters},{default:f(({item:o})=>[d("td",je,l(o.id),1),_(j,null,{default:f(()=>[d("div",Be,[d("div",Ce,[d("img",{class:"h-10 w-10",src:o.country.photo_path,alt:"Country Flag"},null,8,Pe)]),d("div",$e,[d("div",Ve,l(o.name),1),d("div",Le,l(o.hostname),1)])])]),_:2},1024),_(j,null,{default:f(()=>[d("div",Ie,l(o.ip_address)+" : "+l(o.join_port),1),d("div",We,l(a(t)("WebQuery: :webquery_port",{webquery_port:o.webquery_port||a(t)("not set")})),1)]),_:2},1024),_(j,null,{default:f(()=>[N(l(o.type.key),1)]),_:2},1024),d("td",qe,[d("div",ze,[v[o.id]===1?(c(),b("span",Je,l(a(t)("Server Online")),1)):v[o.id]===-1?(c(),b("span",Re,l(a(t)("Server Offline")),1)):(c(),b("span",Me,l(a(t)("Loading"))+"...",1))]),d("div",Fe,[p[o.id]===1?(c(),b("span",Qe,l(a(t)("WebQuery Online")),1)):p[o.id]===-1?(c(),b("span",He,l(a(t)("WebQuery Offline")),1)):p[o.id]===0?(c(),b("span",Ye)):(c(),b("span",Ke,l(a(t)("Loading"))+"...",1))])]),_(j,null,{default:f(()=>[N(l(o.minecraft_version),1)]),_:2},1024),_(j,null,{default:f(()=>[o.type.value===5?(c(),b("span",Ue,l(a(t)("not applicable")),1)):T((c(),b("span",{key:1,title:a(S)(o.last_scanned_at)},[N(l(o.last_scanned_at?a(m)(o.last_scanned_at):a(t)("not scanned yet")),1)],8,Xe)),[[h]])]),_:2},1024),d("td",Ge,[T((c(),k(u,{as:"a",title:a(t)("View Server Intel"),href:n.route("admin.server.show",o.id),class:"inline-flex items-center justify-center text-blue-500 hover:text-blue-800"},{default:f(()=>[_(a(fe),{class:"inline-block w-5 h-5"})]),_:2},1032,["title","href"])),[[h]]),a(r)("update servers")?T((c(),k(u,{key:0,as:"a",href:n.route("admin.server.edit",o.id),class:"inline-flex items-center justify-center text-yellow-600 dark:text-yellow-500 hover:text-yellow-800 dark:hover:text-yellow-800",title:a(t)("Edit Server")},{default:f(()=>[_(a(pe),{class:"inline-block w-5 h-5"})]),_:2},1032,["href","title"])),[[h]]):E("",!0),a(r)("delete servers")?T((c(),k(u,{key:1,as:"button",method:"DELETE",href:n.route("admin.server.delete",o.id),class:"inline-flex items-center justify-center text-red-600 hover:text-red-900 focus:outline-none",title:a(t)("Delete Server")},{default:f(()=>[_(a(ye),{class:"inline-block w-5 h-5"})]),_:2},1032,["href","title"])),[[x,{message:"Are you sure you want to delete this Server permanently?"}],[h]]):E("",!0)])]),_:1},8,["data","filters"])])]),_:1})}}};export{ct as default};
