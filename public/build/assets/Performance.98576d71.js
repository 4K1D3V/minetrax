import{r as g,h as O,y as D,o as v,d as k,a as s,b as n,f as c,t as e,u as t,A as P,I as C,a4 as T,c as S,w as $,C as I}from"./app.42e0fd93.js";import{_ as F}from"./AdminLayout.9f0f10d6.js";import{_ as j}from"./Chart.c7221acd.js";import{i as G}from"./index.es.8304ba97.js";import{I as i,u as N}from"./AppLayout.bc5e16a8.js";import{s as y,e as f,a as w,b as M,c as L,d as R,f as U}from"./index.8b86a400.js";import{L as V}from"./LoadingSpinner.35bf595a.js";import{_ as Y}from"./ServerIntelServerSelector.5d5d677e.js";import"./useAuthorizable.9ef6cf28.js";import"./XSelect.0091104e.js";const H={class:"w-full h-full p-3 space-y-8 bg-white rounded shadow dark:bg-cool-gray-800"},q={class:"flex justify-between"},z={class:"font-extrabold text-gray-800 dark:text-gray-200 flex items-center"},E={__name:"ServerPerformanceOverTimeMetricBox",props:{servers:{type:Array,required:!1}},setup(m){const u=m,{__:l}=C();let a=g({}),d=g(null),h=g(!0),o=g(null);const x=O(()=>o.value===null||o.value.length<=0||o.value[0]===null||o.value[1]===null);async function b(){h.value=!0;let r={};x.value||(r.from_date=o.value[0],r.to_date=o.value[1]),u.servers&&u.servers.length>0&&(r.servers=u.servers);const _=await T.get(route("admin.graph.server-performance",r));h.value=!1,d.value=_.data,a.value={tooltip:{trigger:"axis",position:function(p){return[p[0],"10%"]}},legend:{},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},xAxis:{type:"time"},yAxis:{type:"value",boundaryGap:[0,"10%"]},dataZoom:[{type:"inside",start:90,end:100,zoomLock:!0},{start:90,end:100}],series:d.value.labels.map((p,B)=>({name:p,type:"line",smooth:!0,symbol:"none",seriesLayoutBy:"column",encode:{y:B+1},emphasis:{focus:"series"}})),dataset:{source:d.value.data}}}D(async()=>{await b()});const A=[{text:l("Today"),onClick(){const r=new Date;return[y(r),f(r)]}},{text:l("Yesterday"),onClick(){const r=w(new Date,1);return[y(r),f(r)]}},{text:l("Last 7 Days"),onClick(){const r=new Date,_=w(r,7);return[y(_),f(r)]}},{text:l("Last 30 Days"),onClick(){const r=new Date,_=w(r,30);return[y(_),f(r)]}},{text:l("This Month"),onClick(){const r=new Date,_=M(r);return[y(_),f(r)]}},{text:l("Last Month"),onClick(){const r=new Date,_=M(L(r,1)),p=R(L(r,1));return[y(_),f(p)]}},{text:l("This Year"),onClick(){const r=new Date,_=U(r);return[y(_),f(r)]}}];return(r,_)=>(v(),k("div",H,[s("div",q,[s("h3",z,[n(i,{name:"cpu",class:"w-6 mr-1"}),c(" "+e(t(l)("Performance over time")),1)]),n(t(G),{value:t(o),"onUpdate:value":_[0]||(_[0]=p=>P(o)?o.value=p:o=p),type:"date",range:"",placeholder:t(l)("View for date range"),"input-class":"block w-full p-2 text-sm border-gray-300 rounded-md focus:border-light-blue-300 focus:ring focus:ring-light-blue-200 focus:ring-opacity-50 dark:bg-cool-gray-900 dark:text-gray-300 dark:border-gray-900",shortcuts:A,onChange:_[1]||(_[1]=p=>b())},null,8,["value","placeholder"])]),n(j,{options:t(a),height:"350px",loading:t(h),autoresize:!0},null,8,["options","loading"])]))}},Z={class:"flex"},K={class:"bg-white dark:bg-cool-gray-800 rounded w-full h-full p-3 shadow"},J={class:"font-extrabold text-gray-800 dark:text-gray-200 flex mt-2 items-center"},Q={key:0,class:"h-80 flex justify-center items-center"},W={key:1,class:"m-0 p-0"},X={class:"table-auto min-w-full text-sm dark:text-gray-300 text-gray-700"},ss={class:"border-b dark:border-gray-700"},ts=s("th",{scope:"col",class:"text-left p-2"},null,-1),es={scope:"col",class:"text-left p-2"},as={scope:"col",class:"text-left p-2"},os={scope:"col",class:"text-left p-2"},rs={scope:"col",class:"text-left p-2"},ls={class:"p-2 flex"},ns={class:"p-2"},_s={class:"p-2"},ds={class:"p-2"},cs={class:"p-2"},is={class:"p-2 flex"},us={class:"p-2"},ps={class:"p-2"},hs={class:"p-2"},ms={class:"p-2"},ys={class:"p-2 flex"},fs={class:"p-2"},gs={class:"p-2"},vs={class:"p-2"},xs={class:"p-2"},ks={class:"p-2 flex"},ws={class:"p-2"},bs={class:"p-2"},Ms={class:"p-2"},Ls={class:"p-2"},Ds={class:"p-2 flex"},As={class:"p-2"},Bs={class:"p-2"},Os={class:"p-2"},Ps={class:"p-2"},Cs={class:"p-2 flex"},Ts={class:"p-2"},Ss={class:"p-2"},$s={class:"p-2"},Is={class:"p-2"},Fs={class:"p-2 flex"},js={class:"p-2"},Gs={class:"p-2"},Ns={class:"p-2"},Rs={class:"p-2"},Us={class:"p-2 flex"},Vs={class:"p-2"},Ys={class:"p-2"},Hs={class:"p-2"},qs={class:"p-2"},zs={class:"p-2 flex"},Es={class:"p-2"},Zs={class:"p-2"},Ks={class:"p-2"},Js={class:"p-2"},Qs={__name:"ServerIntelPerformanceNumbersBox",props:{servers:{type:Array,required:!1}},setup(m){const u=m,{secondsToHMS:l}=N();let a=g(null),d=g(!0);async function h(){d.value=!0;let o={};u.servers&&u.servers.length>0&&(o.servers=u.servers);const x=await axios.get(route("admin.intel.server.performance.numbers",o));d.value=!1,a.value=x.data.numbers}return D(async()=>{await h()}),(o,x)=>(v(),k("div",Z,[s("div",K,[s("h3",J,[n(i,{name:"calculator",class:"w-6 mr-1"}),c(" "+e(o.__("Numbers")),1)]),t(d)?(v(),k("div",Q,[n(V,{loading:t(d)},null,8,["loading"])])):(v(),k("div",W,[s("table",X,[s("thead",ss,[s("tr",null,[ts,s("th",es,e(o.__("Last 24 hours")),1),s("th",as,e(o.__("Last 7 days")),1),s("th",os,e(o.__("Last 30 days")),1),s("th",rs,e(o.__("Last 3 months")),1)])]),s("tbody",null,[s("tr",null,[s("td",ls,[n(i,{name:"users",class:"w-5 text-green-500 mr-1"}),c(" "+e(o.__("Peak Online Players")),1)]),s("td",ns,e(t(a).max_players.last_24h),1),s("td",_s,e(t(a).max_players.last_7days),1),s("td",ds,e(t(a).max_players.last_30days),1),s("td",cs,e(t(a).max_players.last_90days),1)]),s("tr",null,[s("td",is,[n(i,{name:"finger-print",class:"w-5 text-indigo-500 mr-1"}),c(" "+e(o.__("Avg Player Session Length")),1)]),s("td",us,e(t(l)(t(a).player_avg_session_length.last_24h,!0)),1),s("td",ps,e(t(l)(t(a).player_avg_session_length.last_7days,!0)),1),s("td",hs,e(t(l)(t(a).player_avg_session_length.last_30days,!0)),1),s("td",ms,e(t(l)(t(a).player_avg_session_length.last_90days,!0)),1)]),s("tr",null,[s("td",ys,[n(i,{name:"moon-outline",class:"w-5 text-gray-500 mr-1"}),c(" "+e(o.__("Avg Player AFK Time")),1)]),s("td",fs,e(t(l)(t(a).player_avg_afk_time.last_24h,!0)),1),s("td",gs,e(t(l)(t(a).player_avg_afk_time.last_7days,!0)),1),s("td",vs,e(t(l)(t(a).player_avg_afk_time.last_30days,!0)),1),s("td",xs,e(t(l)(t(a).player_avg_afk_time.last_90days,!0)),1)]),s("tr",null,[s("td",ks,[n(i,{name:"joystick",class:"w-5 text-pink-500 mr-1"}),c(" "+e(o.__("Lowest TPS")),1)]),s("td",ws,e(t(a).low_tps.last_24h),1),s("td",bs,e(t(a).low_tps.last_7days),1),s("td",Ms,e(t(a).low_tps.last_30days),1),s("td",Ls,e(t(a).low_tps.last_90days),1)]),s("tr",null,[s("td",Ds,[n(i,{name:"cpu",class:"w-5 text-blue-500 mr-1"}),c(" "+e(o.__("Avg CPU Usage")),1)]),s("td",As,e(t(a).avg_cpu.last_24h.toFixed(2))+"% ",1),s("td",Bs,e(t(a).avg_cpu.last_7days.toFixed(2))+"% ",1),s("td",Os,e(t(a).avg_cpu.last_30days.toFixed(2))+"% ",1),s("td",Ps,e(t(a).avg_cpu.last_90days.toFixed(2))+"% ",1)]),s("tr",null,[s("td",Cs,[n(i,{name:"ram",class:"w-5 text-orange-500 mr-1"}),c(" "+e(o.__("Avg RAM Usage")),1)]),s("td",Ts,e(Math.round(t(a).avg_memory.last_24h/1024))+" MB ",1),s("td",Ss,e(Math.round(t(a).avg_memory.last_7days/1024))+" MB ",1),s("td",$s,e(Math.round(t(a).avg_memory.last_30days/1024))+" MB ",1),s("td",Is,e(Math.round(t(a).avg_memory.last_90days/1024))+" MB ",1)]),s("tr",null,[s("td",Fs,[n(i,{name:"grid",class:"w-5 text-purple-500 mr-1"}),c(" "+e(o.__("Avg Chunks Loaded")),1)]),s("td",js,e(Math.round(t(a).avg_chunks.last_24h)),1),s("td",Gs,e(Math.round(t(a).avg_chunks.last_7days)),1),s("td",Ns,e(Math.round(t(a).avg_chunks.last_30days)),1),s("td",Rs,e(Math.round(t(a).avg_chunks.last_90days)),1)]),s("tr",null,[s("td",Us,[n(i,{name:"server",class:"w-5 text-light-blue-500 mr-1"}),c(" "+e(o.__("Min Free Disk")),1)]),s("td",Vs,e(Math.round(t(a).min_free_disk.last_24h/1048576))+" GB ",1),s("td",Ys,e(Math.round(t(a).min_free_disk.last_7days/1048576))+" GB ",1),s("td",Hs,e(Math.round(t(a).min_free_disk.last_30days/1048576))+" GB ",1),s("td",qs,e(Math.round(t(a).min_free_disk.last_90days/1048576))+" GB ",1)]),s("tr",null,[s("td",zs,[n(i,{name:"toggle-off",class:"w-5 text-red-500 mr-1"}),c(" "+e(o.__("Total Restarts")),1)]),s("td",Es,e(t(a).total_restarts.last_24h),1),s("td",Zs,e(t(a).total_restarts.last_7days),1),s("td",Ks,e(t(a).total_restarts.last_30days),1),s("td",Js,e(t(a).total_restarts.last_90days),1)])])])]))])]))}},Ws={class:"p-4 mx-auto space-y-4 max-w-7xl"},dt={__name:"Performance",props:{serverList:{type:Object},filters:{type:Object}},setup(m){const u=m;return(l,a)=>(v(),S(F,null,{default:$(()=>{var d,h;return[n(I,{title:l.__("Performance - ServerIntel")},null,8,["title"]),s("div",Ws,[n(Y,{title:l.__("Server Performance"),"server-list":u.serverList,filters:u.filters},null,8,["title","server-list","filters"]),n(E,{servers:(d=m.filters)==null?void 0:d.servers},null,8,["servers"]),n(Qs,{servers:(h=m.filters)==null?void 0:h.servers},null,8,["servers"])])]}),_:1}))}};export{dt as default};
